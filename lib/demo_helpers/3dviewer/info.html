<!DOCTYPE html>
<html lang="en">

<head>
  <meta name="description" content="MuggledDPT 3D Viewer Info" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>Info</title>
</head>

<style>
  body {
    font-family: monospace;
    display: flex;
    flex-flow: column nowrap;
    align-items: center;
    max-width: 60rem;
    margin: auto;
    background-color: rgb(80,80,80);
    color: white;
    font-size: 1rem;
  }

  h1 {
    text-align: center;
  }

  h2 {
    font-size: 1.25rem;
    margin-top: 3rem;
    margin-bottom: 0;
    text-decoration: underline;
  }

  p {
    color: rgb(220, 220, 180);
    text-align: justify;
  }

  section {
    margin-top: 3rem;
    display: flex;
    flex-flow: column nowrap;
    width: 100%;
  }

</style>

<body>

  <section>

    <h1>3D Viewer Controls</h1>

    <p>Note: All sliders can be reset by double-clicking on the slider label or numeric indicator. The camera positioning can be reset by double clicking anywhere in the main viewport.</p>
    
    <h2>Min Depth:</h2>
    <p>This value determines the distance (depth) to the closest object in the image. It's specified as a percentage of the maximum depth. For example, a <b>Min Depth</b> of 100 would imply that the closest object is the same distance from the camera as the farthest object, resulting in a flat 3D surface. A <b>Min Depth</b> of 0 would imply the closest part of the scene is 'touching' the camera.</p>
    <p>This is the single most important value to set correctly for obtaining an accurate depth mapping!</p>
    
    <h2>Max Depth:</h2>
    <p>This value represents how far away the farthest part of the scene is from the camera. Changes to this value aren't very important within this 3Dviewer, but it will affect the size of the model when exported (i.e. how big the model is when imported into other 3D software). The upper limit value can be adjusted using the <b>CTRLS</b> variable in the console.</p>
    

    <h2>FOV:</h2>
    <p>The field of view (fov) setting is meant to be set to match the fov of the camera used to capture the image data that is being visualized. Larger values have the effect of 'spreading out' distant parts of the scene.</p>
    <p>Telephoto lenses tend to have low fov values, while action cameras (e.g. GoPro) have large fov values.</p>

    <h2>View Tilt:</h2>
    <p>This control can adjust the viewing angle used within the 3D viewer. This can be helpful for images taken from a top-down perspective, as it can lead to more intuitive camera orbitting behavior. Note that this does not affect the model geometry itself (it won't be rotated if saved and imported into other 3D software).</p>
    
    <h2>View Offset:</h2>
    <p>The view offset provides a convenient way to anchor the camera. When set to 0, the 'viewer camera' (i.e. the camera that is viewing the 3D model) will orbit the position of the 'image camera' (i.e. the camera that took the image that is being visualized). When set to 100, the camera will orbit the farthest point/plane of the 3D model. When set to 50, it will orbit the 'minimum depth' plane of the scene.</p>
    <p>Note the camera can still be freely moved, but will do so in addition to the view offset.</p>
    

    <h2>Mesh Density:</h2>
    <p>This value controls the number of points/triangles used to create the 3D mesh for display. Higher values will improve the detail of the mesh, but can be slower to render.</p>
    <p>The number of faces will be given by: max_faces * (density/100)<sup>4</sup></p>
    <p>(where max_faces defaults to 5 million but can be changed using the <b>CTRLS</b> variable in the console)</p>
    
    <h2>Mesh Jitter:</h2>
    <p>By default, the 3D mesh is generated using a simple grid of points. The jitter value randomizes the positioning of points within the grid, which can reduce the appearance of repetitive patterns.</p>
    <p>It's easiest to see the effect of jitter when using low mesh density values. A jitter value of 0 fully disables the effect.</p>
    
    <h2>Edge Threshold:</h2>
    <p>This threshold can be used to exclude regions of the 3D mesh based on the steepness of regions of the depth prediction.</p>
    <p>Alternatively, a mask image can be provided when running the 3D viewer server (using the -k flag), in which case this threshold will be applied to the provided mask.</p>


    <h2>Display Resolution:</h2>
    <p>This control can be used to downscale the displayed image. This can improve rendering speeds as well as help blend together point rendering, at the cost of reduced image quality.</p>

    <h2>Point size:</h2>
    <p>This controls the size of points when displaying as a point cloud. It does nothing when rendering with triangles.</p>

    
    <h2>Use Ortho Camera:</h2>
    <p>If enabled, the viewing camera (e.g. your view point) will use orthographic projection instead of perspective projection. With orthographic projections, objects will appear the same size no matter how far away they are from the camera.</p>
    <p>This can be especially helpful when trying to adjust settings to obtain an accurate 3D representation of the scene.</p>
    
    <h2>Use Triangles:</h2>
    <p>If enabled, the 3D surface will be rendered using triangles instead of points, resulting in a more solid looking surface.</p>
    
    <h2>Use Depth Image:</h2>
    <p>If enabled, the depth map will be used to texture the 3D surface (as a black-and-white image) instead of the original RGB source image.</p>

    <h2>Show Frustrum:</h2>
    <p>If enabled, a visual indicator will be drawn showing the location of the minimum/maximum depth planes as well as the 'image camera' position. This can be useful for understanding how the 3D model is constructed from the prediction and minimum/maximum controls.</p>
    
  </section>

  <section>
    <h1>Extra Controls</h1>
    
    <p>Several additional control values can be modified using the console (F12) in the browser. These controls are not really meant for interactive changes but can affect the visualization. These values can be modified using the global variable: CTRLS</p>
    <p>For example, you can change the maximum depth value using: CTRLS.depth_limit = 500</p>
    <p>This will alter the effect of the existing <b>Max Depth</b> control value, though the change won't be visible until the viewport is updated (e.g. by moving the camera)</p>
  </section>

  <section>
    <h1>Drag-and-Drop</h1>

    <p>Dragging and dropping images into the page will re-run the depth prediction model on the new image, without requiring a restart of the server. This only works for images not video files.</p>
    <p>It's also possible to upload masks for an existing image, as long as the uploaded image has the word 'mask' in the file name. This can be useful for quickly checking the effect of custom-made masks. Masks should be grayscale (though they don't need to be binary), where darker regions denote areas which should be removed.</p>
    <p>On the first upload of a file with 'mask' in the name, a confirmation will ask if the image should be interpretted as a mask (or otherwise as a new color image). Whatever answer is given will be re-used for all future uploads.</p>
  </section>

  <section>
    <h1>Saving 3D Models</h1>

    <p>The 'Save 3D Model' button can be used to save a .glb file, which contains both mesh and texture data. These files can be imported into 3D modeling software (like Blender) or viewed online using GLTF viewers. It's possible to modify the saving (for example, saving as a .obj file instead) by modifying the CTRLS variable in the browser console.</p>
    <p>Note that the current settings of controls will directly affect the resulting model file. So if you'd like to save a proper surface mesh (as opposed to a point cloud), then be sure to enable triangle rendering before saving!</p>
  </section>

  <section>
    <h1>Keyboard shortcuts</h1>
    
    <p><b>Spacebar:</b> Play/pause video (doesn't do anything for static images)</p>
    <p><b>XYZ (+Shift) keys:</b> Snap the camera along the x/y/z axes</b></p>
    <p><b>WASD keys:</b> Move camera origin</p>
    <p><b>H key:</b> Show/hide the UI</p>
    <p><b>O key:</b> Toggle orthographic projection</p>
    <p><b>T key:</b> Toggle points vs. triangle rendering</p>
    <p><b>V key:</b> Toggle use of depth image for surface texturing</p>
    <p><b>M key:</b> Toggle masking</p>
    <p><b>L key:</b> Toggle line rendering</p>
    <p><b>` or ~ key:</b> Enable recording (this can be very demanding!). The background will change color to indicate active recording</p>
    <p><b>+/- keys:</b> Adjust the display resolution</p>
    <p><b>[ or ] keys:</b> Adjust point sizing (only affects point rendering mode)</p>
    
    <p><b>Shift + click</b> or <b>middle click</b> to pan the camera</p>
    <p><b>Double click:</b> Reset the camera positioning (or reset slider controls by double-clicking labels)</p>
  </section>
    
<script>
</script>

</body>
</html>
